<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ƒê·ªÅ Thi K·ªπ NƒÉng Nghe Ti·∫øng Vi·ªát</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap');
        body {
            font-family: 'Inter', sans-serif;
            background-color: #f3f4f6;
            color: #333;
            margin-bottom: 60px;
        }
        .container {
            max-width: 1000px;
        }
        .info-box, .contact-box, .instruction-box, .indicator-box, .question-card, .controls-container {
            border-radius: 0.2rem;
            background-color: #85ae5f;
            color: #000000;
        }
        .question-option {
            cursor: pointer;
            transition: transform 0.2s, background-color 0.2s;
        }
        .question-option:hover {
            transform: translateY(-2px);
            background-color: #f1f5f9;
        }
        .question-option.selected {
            background-color: #d1d5db;
        }
        .controls-container {
            position: fixed;
            bottom: 0;
            left: 50%;
            transform: translateX(-50%);
            width: 100%;
            max-width: 600px;
            padding: 1rem;
            background: linear-gradient(to top, rgba(255, 255, 255, 0.95), rgba(255, 255, 255, 0.8));
            backdrop-filter: blur(5px);
            -webkit-backdrop-filter: blur(5px);
            z-index: 1000;
        }
        .floating-controls {
            position: fixed;
            top: 20px;
            right: 20px;
            background-color: #e0eedb;
            padding: 10px;
            border-radius: 5px;
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.2);
            text-align: center;
            display: block;
            z-index: 1000;
        }
        #audioPlayer {
            width: 100%;
            margin-bottom: 5px;
        }
        .time-row {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 10px;
            margin-bottom: 10px;
        }
        .time-box-group {
            display: flex;
            justify-content: center;
            gap: 10px;
        }
        .button-group {
            display: flex;
            justify-content: center;
            gap: 10px;
        }
        .floating-controls p#timeDisplay {
            font-size: 28px;
            color: #FFFFFF;
            background-color: #000000;
            padding: 5px 10px;
            border-radius: 5px;
            cursor: pointer;
            margin: 0;
        }
        .floating-controls .time-box {
            font-size: 16px;
            color: #FFFFFF;
            background-color: #555555;
            padding: 5px 10px;
            border-radius: 5px;
            min-width: 60px;
        }
        .tua-buttons {
            display: flex;
            justify-content: center;
            gap: 5px;
            margin-bottom: 10px;
            flex-wrap: wrap;
        }
        .action-buttons {
            display: flex;
            justify-content: center;
            gap: 10px;
        }
        .control-button {
            width: 50px;
            height: 50px;
            background-color: #363535;
            color: white;
            border: none;
            border-radius: 50%;
            font-size: 14px;
            font-weight: bold;
            cursor: pointer;
            display: inline-flex;
            justify-content: center;
            align-items: center;
        }
        .control-button:disabled,
        .control-button.disabled {
            background-color: #888888;
            cursor: not-allowed;
            display: none;
        }
        .control-button:hover:not(:disabled):not(.disabled) {
            background-color: #000000;
        }
        .pause-play-button {
            background-color: #FF4500;
        }
        .pause-play-button:hover:not(:disabled):not(.disabled) {
            background-color: #CC3700;
        }
        .toggle-button {
            background-color: #4682B4;
        }
        .toggle-button:hover:not(:disabled):not(.disabled) {
            background-color: #36648B;
        }
        .loop-button {
            background-color: #3c923c;
        }
        .loop-button:hover:not(:disabled):not(.disabled) {
            background-color: #347d34;
        }
        .clear-button {
            background-color: #bc3f13;
        }
        .clear-button:hover:not(:disabled):not(.disabled) {
            background-color: #d15124;
        }
        .indicator-item {
            cursor: pointer;
        }
        .indicator-item:hover {
            background-color: #e5e7eb;
        }
        .indicator-item.active {
            background-color: #fef3c7;
            border: 2px solid #f59e0b;
        }
        @media (max-width: 768px) { 
            body {
                margin-bottom: 200px;
            }
            .floating-controls {
                top: 10px;
                right: 10px;
                padding: 5px;
            }
        }
        @media (max-width: 400px) {
            .control-button {
                width: 40px;
                height: 40px;
                font-size: 14px;
            }
            .floating-controls p#timeDisplay {
                font-size: 20px;
            }
            .floating-controls .time-box {
                font-size: 12px;
                min-width: 50px;
            }
        }
        .highlighted {
            background-color: #fef3c7;
            border: 2px solid #f59e0b;
        }
    </style>
</head>
<body class="p-4 md:p-8">
    <div class="container mx-auto grid grid-cols-1 md:grid-cols-4 gap-6">
        <!-- Left Sidebar -->
        <div class="md:col-span-1 space-y-1">
            <div id="infoBox" class="info-box p-2">
                <h3 class="text-3xl font-bold mb-2" style="color: #f7e19c;">‰π†ÂæóË∂äÂçóËØ≠</h3>
                <h4 class="text-lg mb-2" style="color: #ffffff;">Ë∂äÂçóËØ≠ËÉΩÂäõÊµãËØï-Âê¨ÂäõÈÉ®ÂàÜ</h4>
            </div>
            <div id="contactBox" class="contact-box p-1 h-13">
                <h3 class="text-sm font-bold mb-1" style="color: #f7e19c;">ËÅîÁ≥ªÂ≠¶‰π†Ë∂äÂçóËØ≠ - ÈòÆÁéâÁÖå</h3>
                <h4 class="text-sm mb-1" style="color: #ffffff;">WeixinÔºöXiDeYueNanYu</h4>
            </div>
            <div id="instructionBox" class="instruction-box p-1 h-13">
                <h3 class="text-sm font-bold mb-1" style="color: #f7e19c;">ÂΩìÂâç‰ΩçÁΩÆ</h3>
                <div id="current-section" class="text-sm font-semibold text-center text-blue-600" style="color: #073763;"></div>
            </div>
            <div id="indicatorBox" class="indicator-box bg-white p-1">
                <h5 class="text-sm font-bold mb-1" style="color: #85ae5f;">Êú™ÈÄâÊã©-Â∑≤ÈÄâÊã©</h5>
                <div id="indicator-list" class="flex flex-wrap gap-2 text-center text-[8px]"></div>
            </div>
        </div>

        <!-- Main Content -->
        <div class="md:col-span-3 space-y-6">
            <div id="question-container" class="question-container bg-white p-6 pb-32 md:pb-6">
                <!-- Questions will be rendered here dynamically -->
            </div>
        </div>
    </div>

    <!-- Floating Controls -->
    <div class="controls-container flex flex-col items-center justify-center space-y-4">
        <div class="flex items-center space-x-4">
            <label for="autoContinue" class="flex items-center text-sm cursor-pointer">
                <input type="checkbox" id="autoContinue" class="h-4 w-4 text-green-600 rounded">
                <span class="ml-2 text-green-700 font-medium">Ëá™Âä®ÁªßÁª≠</span>
            </label>
        </div>
        <div class="flex items-center space-x-3 w-full max-w-sm">
            <button id="prevBtn" class="flex-grow bg-[#85ae5f] text-white py-2 px-3 rounded-[10px] font-bold shadow-md hover:bg-[#9dbe7e] transition-colors duration-200">‚óÄ
            </button>
            <div id="questionNumberDisplay" class="flex-shrink-0 text-center text-xl font-bold bg-[#f1cc76] text-black rounded-[10px] w-20 h-10 flex items-center justify-center shadow-lg">1</div>
            <button id="nextBtn" class="flex-grow bg-[#85ae5f] text-white py-2 px-3 rounded-[10px] font-bold shadow-md hover:bg-[#9dbe7e] transition-colors duration-200">‚ñ∂
            </button>
            <button id="replayBtn" class="flex-grow bg-[#85ae5f] text-white py-2 px-3 rounded-[10px] font-bold shadow-md hover:bg-[#9dbe7e] transition-colors duration-200">
                <i class="fas fa-redo-alt mr-2"></i>ÂÜçÂê¨‰∏ÄÈÅç
            </button>
        </div>
    </div>

    <!-- Integrated Audio Floating Controls -->
    <div class="floating-controls" id="floatingControls">
        <audio id="audioPlayer" src="" controls></audio>
        <div class="time-row">
            <p id="timeDisplay">00:00</p>
            <div class="time-box-group">
                <span class="time-box" id="loopStart">--:--</span>
                <span class="time-box" id="loopEnd">--:--</span>
            </div>
            <div class="button-group">
                <button class="control-button loop-button" id="loopButton">Âê¨</button>
                <button class="control-button clear-button" id="clearButton">Âà†</button>
            </div>
        </div>
        <div class="tua-buttons">
            <button class="control-button" id="rewind5sButton">-5s</button>
            <button class="control-button" id="rewind1sButton">-1s</button>
            <button class="control-button" id="forward1sButton">+1s</button>
            <button class="control-button" id="forward5sButton">+5s</button>
        </div>
        <div class="action-buttons">
            <button class="control-button pause-play-button" id="pausePlayButton">Êí≠</button>
            <button class="control-button toggle-button" id="toggleControlsButton">Ëóè</button>
        </div>
    </div>

    <script>
document.addEventListener('DOMContentLoaded', () => {
    // --- ARRAY DECLARATIONS ---
    // üëâ D√°n l·∫°i c√°c m·∫£ng sentenceP1, sentenceP2ht, sentenceP2mt, sentenceP2bn, sentenceP3ht, sentenceP3bn, sentenceP4 c·ªßa b·∫°n t·∫°i ƒë√¢y
    // const baseAudioUrl = "https://www.soundhelix.com/examples/mp3/SoundHelix-Song-";
	// --- END ARRAY DECLARATIONS ---
            const sentenceP1 = [
    {
        "audioFile": "sentenceP1.mp3",
        "start": 0.43102,
        "end": 1.75102,
        "notes": "Nghe v√† ch·ªçn ƒë√°p √°n ƒë√∫ng.",
        "question": "Ng∆∞·ªùi nghe s·∫Ω tr·∫£ l·ªùi th·∫ø n√†o?",
        "correctAnswer": "T√¥i t√™n l√† Hoa.",
        "options": [
            "T√¥i t√™n l√† Hoa.",
            "Ch·ªã ·∫•y t√™n l√† Hoa.",
            "Ch·ªã Hoa ƒë·∫•y."
        ]
    },
    {
        "audioFile": "sentenceP1.mp3",
        "start": 2.23102,
        "end": 3.83102,
        "notes": "Nghe v√† ch·ªçn ƒë√°p √°n ƒë√∫ng.",
        "question": "Ng∆∞·ªùi nghe s·∫Ω tr·∫£ l·ªùi th·∫ø n√†o?",
        "correctAnswer": "T√¥i l√† ng∆∞·ªùi Ph√°p.",
        "options": [
            "T√¥i l√† ng∆∞·ªùi Ph√°p.",
            "T·ªõ ƒë·∫øn t·ª´ Ph√°p.",
            "Anh ·∫•y mang qu·ªëc t·ªãch Ph√°p."
        ]
    },
    {
        "audioFile": "sentenceP1.mp3",
        "start": 4.37102,
        "end": 6.37102,
        "notes": "Nghe v√† ch·ªçn ƒë√°p √°n ƒë√∫ng.",
        "question": "Ng∆∞·ªùi nghe s·∫Ω tr·∫£ l·ªùi th·∫ø n√†o?",
        "correctAnswer": "C√≥, B√† ·∫•y bi·∫øt m·ªôt ch√∫t ti·∫øng Vi·ªát.",
        "options": [
            "Kh√¥ng, b√† ·∫•y h·ªçc ti·∫øng Vi·ªát ƒë∆∞·ª£c m·ªôt ch√∫t.",
            "B√† h·ªçc ti·∫øng Vi·ªát c√°ch ƒë√¢y hai th√°ng r·ªìi.",
            "C√≥, B√† ·∫•y bi·∫øt m·ªôt ch√∫t ti·∫øng Vi·ªát."
        ]
    },
    {
        "audioFile": "sentenceP1.mp3",
        "start": 6.90102,
        "end": 8.61102,
        "notes": "Nghe v√† ch·ªçn ƒë√°p √°n ƒë√∫ng.",
        "question": "Ng∆∞·ªùi nghe s·∫Ω tr·∫£ l·ªùi th·∫ø n√†o?",
        "correctAnswer": "H√¥m qua l√† th·ª© s√°u.",
        "options": [
            "Ng√†y qua l√† th·ª© b·∫£y.",
            "H√¥m qua l√† ng√†y 20.",
            "H√¥m qua l√† th·ª© s√°u."
        ]
    },
    {
        "audioFile": "sentenceP1.mp3",
        "start": 9.23102,
        "end": 11.56102,
        "notes": "Nghe v√† ch·ªçn ƒë√°p √°n ƒë√∫ng.",
        "question": "Ng∆∞·ªùi nghe s·∫Ω tr·∫£ l·ªùi th·∫ø n√†o?",
        "correctAnswer": "Em l√† sinh vi√™n nƒÉm th·ª© t∆∞ ·∫°!",
        "options": [
            "Em l√† sinh vi√™n nƒÉm th·ª© b·ªën ·∫°!",
            "Em l√† sinh vi√™n nƒÉm th·ª© t∆∞ ·∫°!",
            "Em sinh nƒÉm 94."
        ]
    },
    {
        "audioFile": "sentenceP1.mp3",
        "start": 12.05102,
        "end": 13.55102,
        "notes": "Nghe v√† ch·ªçn ƒë√°p √°n ƒë√∫ng.",
        "question": "Ng∆∞·ªùi nghe s·∫Ω tr·∫£ l·ªùi th·∫ø n√†o?",
        "correctAnswer": "√îng ·∫•y ƒëang ng·ªß.",
        "options": [
            "√îng kh·ªèi r·ªìi.",
            "√îng ·∫•y ƒë·ª° r·ªìi.",
            "√îng ·∫•y ƒëang ng·ªß."
        ]
    },
    {
        "audioFile": "sentenceP1.mp3",
        "start": 14.11102,
        "end": 18.15102,
        "notes": "Nghe v√† ch·ªçn ƒë√°p √°n ƒë√∫ng.",
        "question": "Ng∆∞·ªùi nghe s·∫Ω tr·∫£ l·ªùi th·∫ø n√†o?",
        "correctAnswer": "Kho·∫£ng 1 c√¢y s·ªë ch·ªã ·∫°!",
        "options": [
            "Kh√¥ng xa l·∫Øm ƒë√¢u!",
            "Kho·∫£ng 1 c√¢y s·ªë ch·ªã ·∫°!",
            "Ch·ªã c·ª© ƒëi th·∫≥ng l√† t·ªõi th√¥i!"
        ]
    },
    {
        "audioFile": "sentenceP1.mp3",
        "start": 18.59102,
        "end": 19.90102,
        "notes": "Nghe v√† ch·ªçn ƒë√°p √°n ƒë√∫ng.",
        "question": "Ph√°t ng√¥n tr√™n c√≥ m·∫•y lo·∫°i thanh ƒëi·ªáu?",
        "correctAnswer": "Ba",
        "options": [
            "M·ªôt",
            "Hai",
            "Ba"
        ]
    },
    {
        "audioFile": "sentenceP1.mp3",
        "start": 20.35102,
        "end": 23.71102,
        "notes": "Nghe v√† ch·ªçn ƒë√°p √°n ƒë√∫ng.",
        "question": "Ph√°t ng√¥n tr√™n c√≥ m·∫•y lo·∫°i thanh ƒëi·ªáu?",
        "correctAnswer": "B·ªën",
        "options": [
            "B·ªën",
            "NƒÉm",
            "S√°u"
        ]
    },
    {
        "audioFile": "sentenceP1.mp3",
        "start": 24.18102,
        "end": 26.22102,
        "notes": "Nghe v√† ch·ªçn ƒë√°p √°n ƒë√∫ng.",
        "question": "Ng∆∞·ªùi nghe s·∫Ω tr·∫£ l·ªùi th·∫ø n√†o?",
        "correctAnswer": "T√¥i ƒë·∫øn ƒë√¢y b·∫±ng xe m√°y.",
        "options": [
            "T√¥i ƒëi l√†m b·∫±ng √¥ t√¥.",
            "T√¥i ƒë·∫øn ƒë√≥ b·∫±ng ph∆∞∆°ng ti·ªán xe m√°y.",
            "T√¥i ƒë·∫øn ƒë√¢y b·∫±ng xe m√°y."
        ]
    },
    {
        "audioFile": "sentenceP1.mp3",
        "start": 26.77102,
        "end": 28.86102,
        "notes": "Nghe v√† ch·ªçn ƒë√°p √°n ƒë√∫ng.",
        "question": "Ph√°t ng√¥n tr√™n c√≥ nghƒ©a l√†?",
        "correctAnswer": "T√¥i kh√¥ng bi·∫øt ch·ªã ·∫•y l√† ai.",
        "options": [
            "T√¥i c√≥ bi·∫øt ch·ªã ·∫•y.",
            "T√¥i kh√¥ng quen ch·ªã ·∫•y.",
            "T√¥i kh√¥ng bi·∫øt ch·ªã ·∫•y l√† ai."
        ]
    },
    {
        "audioFile": "sentenceP1.mp3",
        "start": 29.35102,
        "end": 31.25102,
        "notes": "Nghe v√† ch·ªçn ƒë√°p √°n ƒë√∫ng.",
        "question": "Ph√°t ng√¥n tr√™n l√† ph√°t ng√¥n nh∆∞ th·∫ø n√†o?",
        "correctAnswer": "ch·∫•p nh·∫≠n mi·ªÖn c∆∞·ª°ng.",
        "options": [
            "ƒë√°nh gi√°, nh·∫≠n x√©t v·ªÅ m√≥n Ph·ªü.",
            "ch·∫•p nh·∫≠n mi·ªÖn c∆∞·ª°ng.",
            "ph√™ ph√°n m√≥n Ph·ªü."
        ]
    },
    {
        "audioFile": "sentenceP1.mp3",
        "start": 31.79102,
        "end": 33.90102,
        "notes": "Nghe v√† ch·ªçn ƒë√°p √°n ƒë√∫ng.",
        "question": "Ph√°t ng√¥n tr√™n c√≥ nghƒ©a l√†?",
        "correctAnswer": "H·ªç ƒë√£ ƒëi ch∆°i trong nhi·ªÅu tu·∫ßn nay r·ªìi.",
        "options": [
            "Tu·∫ßn n√†o h·ªç c≈©ng ƒëi ch∆°i.",
            "H·ªç ƒë√£ ƒëi ch∆°i trong nhi·ªÅu tu·∫ßn nay r·ªìi.",
            "H·ªç s·∫Ω ƒëi ch∆°i nhi·ªÅu tu·∫ßn v√†o th·ªùi gian t·ªõi."
        ]
    },
    {
        "audioFile": "sentenceP1.mp3",
        "start": 34.52102,
        "end": 36.84102,
        "notes": "Nghe v√† ch·ªçn ƒë√°p √°n ƒë√∫ng.",
        "question": "Ph√°t ng√¥n tr√™n c√≥ nghƒ©a l√†?",
        "correctAnswer": "Anh ·∫•y th√¥i vi·ªác r·ªìi th√¨ ph·∫£i.",
        "options": [
            "Ng∆∞·ªùi ta b·∫£o t√¥i anh ·∫•y th√¥i vi·ªác r·ªìi.",
            "T√¥i ƒë∆∞·ª£c bi·∫øt l√† anh ·∫•y t·ª´ ch·ª©c r·ªìi.",
            "Anh ·∫•y th√¥i vi·ªác r·ªìi th√¨ ph·∫£i."
        ]
    },
    {
        "audioFile": "sentenceP1.mp3",
        "start": 37.33102,
        "end": 40.51102,
        "notes": "Nghe v√† ch·ªçn ƒë√°p √°n ƒë√∫ng.",
        "question": "Ph√°t ng√¥n tr√™n c√≥ nghƒ©a l√†?",
        "correctAnswer": "M√¨nh kh√¥ng ƒë·ªß ti·ªÅn mua.",
        "options": [
            "M√¨nh kh√¥ng ƒë·ªß ti·ªÅn mua.",
            "ƒê·ª£i m√¨nh ƒë·ªß ti·ªÅn s·∫Ω mua.",
            "M√¨nh c√≥ mu·ªën mua xe ƒë√¢u."
        ]
    }
];
            
            const sentenceP2ht = [
                {
                    "audioFile": "sentenceP2ht1.mp3",
                    "notes": "Nghe v√† ch·ªçn ƒë√°p √°n ƒë√∫ng.",
                    "question": "H√† v√† Nam b·∫Øt ƒë·∫ßu ti·∫øt hoÃ£c l√∫c m·∫•y gi·ªù?",
                    "correctAnswer": "7 gi·ªù 5 ph√∫t.",
                    "options": [
                        "7 gi·ªù k√©m 5 ph√∫t.",
                        "7 gi·ªù.",
                        "7 gi·ªù 5 ph√∫t.",
                        "7 gi·ªù qua 10 ph√∫t."
                    ]
                },
                {
                    "audioFile": "sentenceP2ht2.mp3",
                    "notes": "Nghe v√† ch·ªçn ƒë√°p √°n ƒë√∫ng.",
                    "question": "Nana khuy√™n HaÃÄ n√™n ƒëi HaÃÄ Lan du l·ªãch v√†o m√πa n√†o?",
                    "correctAnswer": "M√πa xu√¢n.",
                    "options": [
                        "M√πa xu√¢n.",
                        "M√πa h√®.",
                        "C·∫£ b·ªën m√πa.",
                        "M√πa ƒê√¥ng"
                    ]
                }
            ];
            
            const sentenceP2mt = [
    {
        "audioFile": "sentenceP2mt1.mp3",
        "notes": "Nghe v√† ch·ªçn ƒë√°p √°n ƒë√∫ng.",
        "question": "(...)",
        "correctAnswer": "T√¥i c≈©ng r·∫•t vui ƒë∆∞·ª£c g·∫∑p ch·ªã.",
        "options": [
            "C√°m ∆°n ch·ªã. T√¥i kh·ªèe.",
            "T√¥i c≈©ng r·∫•t vui ƒë∆∞·ª£c g·∫∑p ch·ªã.",
            "Th·∫ø n√†o? Ch·ªã c√≥ kh·ªèe kh√¥ng?",
            "ch·∫Øc ch·∫Øn r·ªìi."
        ]
    },
    {
        "audioFile": "sentenceP2mt2.mp3",
        "notes": "Nghe v√† ch·ªçn ƒë√°p √°n ƒë√∫ng.",
        "question": "(...)",
        "correctAnswer": "Ch·ªã c·ª© b√¨nh tƒ©nh, ƒë·ª´ng lo l·∫Øng qu√°.",
        "options": [
            "Ch·ªã n√™n c·∫©n th·∫≠n.",
            "Ch·ªã c·ª© b√¨nh tƒ©nh, ƒë·ª´ng lo l·∫Øng qu√°.",
            "L√†m g√¨ m√† ch·ªã c·ª© cu·ªëng l√™n th·∫ø.",
            "Th·∫≠t l√† kh√≥ ch·ªãu."
        ]
    },
    {
        "audioFile": "sentenceP2mt3.mp3",
        "notes": "Nghe v√† ch·ªçn ƒë√°p √°n ƒë√∫ng.",
        "question": "(...)",
        "correctAnswer": "Xin l·ªói, cho m√¨nh ƒëi nh·ªù m·ªôt ch√∫t.",
        "options": [
            "C√°c b·∫°n kh√¥ng ƒë∆∞·ª£c ƒë·ª©ng ·ªü ƒë√¢y.",
            "C√°c b·∫°n h√£y tr√°nh ra.",
            "Xin l·ªói, cho m√¨nh ƒëi nh·ªù m·ªôt ch√∫t.",
            "N√†o tr√°nh ra cho ng∆∞·ªùi ta ƒëi n√†o."
        ]
    },
    {
        "audioFile": "sentenceP2mt4.mp3",
        "notes": "Nghe v√† ch·ªçn ƒë√°p √°n ƒë√∫ng.",
        "question": "(...)",
        "correctAnswer": "C√°m ∆°n c·∫≠u.",
        "options": [
            "C√°m ∆°n c·∫≠u.",
            "Kh√¥ng sao.",
            "Kh√¥ng c√≥ g√¨.",
            "Kh√¥ng c√≥ v·∫•n ƒë·ªÅ g√¨ c·∫£."
        ]
    }
];
            
            const sentenceP2bn = [
    {
        "audioFile": "sentenceP2bn1.mp3",
        "notes": "Nghe v√† ch·ªçn ƒë√°p √°n ƒë√∫ng.",
        "question": "N·ªôi dung ch√≠nh c·ªßa b√†i nghe n√≥i v·ªÅ:",
        "correctAnswer": "Ch√†o h·ªèi v√† ch√†o m·ªùi trong ti·∫øng Vi·ªát.",
        "options": [
            "Ch√†o h·ªèi v√† ch√†o m·ªùi trong ti·∫øng Vi·ªát.",
            "Ch√†o h·ªèi trong ti·∫øng Vi·ªát.",
            "C√°c ki·ªÉu ch√†o v√† ch√†o h·ªèi trong ti·∫øng Vi·ªát.",
            "Ch√†o m·ªùi trong ti·∫øng Vi·ªát."
        ]
    },
    {
        "audioFile": "sentenceP2bn1.mp3",
        "notes": "Nghe v√† ch·ªçn ƒë√°p √°n ƒë√∫ng.",
        "question": "Ngo√†i ch√†o h·ªèi b·∫±ng l·ªùi, ng∆∞·ªùi Vi·ªát c√≤n ch√†o h·ªèi nhau b·∫±ng:",
        "correctAnswer": "n·ª• c∆∞·ªùi, √°nh m·∫Øt.",
        "options": [
            "h√†nh vi, ƒë·ªông t√°c.",
            "√Ånh m·∫Øt, b√†n tay.",
            "n·ª• c∆∞·ªùi, √°nh m·∫Øt.",
            "Ng√¥n ng·ªØ c·ª≠ ch·ªâ."
        ]
    },
    {
        "audioFile": "sentenceP2bn2.mp3",
        "notes": "Nghe v√† ch·ªçn ƒë√°p √°n ƒë√∫ng.",
        "question": "Trong ƒëo·∫°n c√°c b·∫°n v·ª´a nghe, si√™u th·ªã n·∫±m ·ªü ƒë√¢u?",
        "correctAnswer": "N·∫±m gi·ªØa hi·ªáu thu·ªëc v√† ti·ªám c·∫Øt t√≥c.",
        "options": [
            "N·∫±m ·ªü b√™n ph·∫£i hi·ªáu thu·ªëc.",
            "N·∫±m ·ªü b√™n tr√°i ti·ªám c·∫Øt t√≥c.",
            "N·∫±m ·ªü gi·ªØa c·ª≠a h√†ng r∆∞·ª£u v√† ti·ªám c·∫Øt t√≥c.",
            "N·∫±m gi·ªØa hi·ªáu thu·ªëc v√† ti·ªám c·∫Øt t√≥c."
        ]
    },
    {
        "audioFile": "sentenceP2bn2.mp3",
        "notes": "Nghe v√† ch·ªçn ƒë√°p √°n ƒë√∫ng.",
        "question": "Ng√£ t∆∞ c√°ch nh√† ga bao xa?",
        "correctAnswer": "Kho·∫£ng 5 ph√∫t ƒëi b·ªô.",
        "options": [
            "Kho·∫£ng 2 km.",
            "Kho·∫£ng 5 ph√∫t ƒëi b·ªô.",
            "Kho·∫£ng 3 km.",
            "Kho·∫£ng 1 km."
        ]
    },
    {
        "audioFile": "sentenceP2bn3.mp3",
        "notes": "Nghe v√† ch·ªçn ƒë√°p √°n ƒë√∫ng.",
        "question": "√ù ch√≠nh c·ªßa ƒëo·∫°n c√°c b·∫°n v·ª´a nghe tr√™n l√† g√¨?",
        "correctAnswer": "N√≥i v·ªÅ ƒë·∫∑c tr∆∞ng c·ªßa th·ªùi ti·∫øt ·ªü th·ªã tr·∫•n Sa Pa.",
        "options": [
            "N√≥i v·ªÅ th·ªùi ti·∫øt ·ªü Sa Pa.",
            "N√≥i v·ªÅ ƒë·∫∑c tr∆∞ng c·ªßa th·ªùi ti·∫øt ·ªü th·ªã tr·∫•n Sa Pa.",
            "N√≥i v·ªÅ l∆∞·ª£ng m∆∞a trung b√¨nh ·ªü Sa Pa.",
            "N√≥i v·ªÅ nhi·ªát ƒë·ªô ·ªü th·ªã tr·∫•n Sa Pa."
        ]
    },
    {
        "audioFile": "sentenceP2bn3.mp3",
        "notes": "Nghe v√† ch·ªçn ƒë√°p √°n ƒë√∫ng.",
        "question": "V√†o m√πa ƒë√¥ng, th·ªùi ti·∫øt ·ªü Sa Pa c√≥ nh·ªØng ƒë·∫∑c ƒëi·ªÉm g√¨?",
        "correctAnswer": "M√¢y m√π bao ph·ªß, l·∫°nh, nhi·ªát ƒë·ªô th·∫•p, ƒë√¥i khi c√≥ tuy·∫øt.",
        "options": [
            "L·∫°nh, nhi·ªát ƒë·ªô th·∫•p, ƒë√¥i khi c√≥ tuy·∫øt.",
            "M√¢y m√π bao ph·ªß, l·∫°nh, nhi·ªát ƒë·ªô th·∫•p, ƒë√¥i khi c√≥ tuy·∫øt.",
            "L·∫°nh, nhi·ªát ƒë·ªô c√≥ khi xu·ªëng d∆∞·ªõi 0oC, ƒë√¥i khi c√≥ tuy·∫øt.",
            "Nhi·ªát ƒë·ªô th·∫•p, c√≥ khi xu·ªëng d∆∞·ªõi 0oC, ƒë√¥i khi c√≥ tuy·∫øt."
        ]
    },
    {
        "audioFile": "sentenceP2bn4.mp3",
        "notes": "Nghe v√† ch·ªçn ƒë√°p √°n ƒë√∫ng.",
        "question": "H√£y cho bi·∫øt, b·∫£n d·ª± b√°o th·ªùi ti·∫øt tr√™n l√† c·ªßa ng√†y n√†o?",
        "correctAnswer": "S√°ng ng√†y 26 th√°ng 12.",
        "options": [
            "S√°ng ng√†y 24 th√°ng 12.",
            "Chi·ªÅu, t·ªëi ng√†y 24 th√°ng 12.",
            "S√°ng ng√†y 25 th√°ng 12.",
            "S√°ng ng√†y 26 th√°ng 12."
        ]
    },
    {
        "audioFile": "sentenceP2bn4.mp3",
        "notes": "Nghe v√† ch·ªçn ƒë√°p √°n ƒë√∫ng.",
        "question": "NƒÉm nay, ng∆∞·ªùi d√¢n mi·ªÅn Trung ƒë√≥n l·ªÖ Gi√°ng sinh trong th·ªùi ti·∫øt nh∆∞ th·∫ø n√†o?",
        "correctAnswer": "Th·ªùi ti·∫øt ƒë·∫πp v√† h·ª≠ng n·∫Øng.",
        "options": [
            "M∆∞a li√™n mi√™n.",
            "Tr·ªùi quang m√¢y t·∫°nh.",
            "Th·ªùi ti·∫øt ƒë·∫πp v√† h·ª≠ng n·∫Øng.",
            "Th·ªùi ti·∫øt l·∫°nh v√† m∆∞a li√™n mi√™n."
        ]
    }
];

            const sentenceP3ht = [
    {
        "audioFile": "sentenceP3ht1.mp3",
        "notes": "Nghe v√† ch·ªçn ƒë√°p √°n ƒë√∫ng.",
        "question": "Hai ng∆∞·ªùi trong h·ªôi tho·∫°i ƒëang n√≥i v·ªÅ ch·ªß ƒë·ªÅ g√¨?",
        "correctAnswer": "V·ªÅ ƒë·∫∑c tr∆∞ng c√°c m√πa ·ªü Vi·ªát Nam.",
        "options": [
            "V·ªÅ th·ªùi ti·∫øt ·ªü mi·ªÅn B·∫Øc Vi·ªát Nam.",
            "V·ªÅ th·ªùi ti·∫øt ·ªü Vi·ªát Nam.",
            "V·ªÅ c√°c m√πa ·ªü Vi·ªát Nam.",
            "V·ªÅ ƒë·∫∑c tr∆∞ng c√°c m√πa ·ªü Vi·ªát Nam."
        ]
    },
    {
        "audioFile": "sentenceP3ht1.mp3",
        "notes": "Nghe v√† ch·ªçn ƒë√°p √°n ƒë√∫ng.",
        "question": "Trong b·ªën m√πa, H√† gh√©t nh·∫•t m√πa n√†o?",
        "correctAnswer": "M√πa h√®.",
        "options": [
            "M√πa h√®.",
            "M√πa xu√¢n v√† m√πa h√®.",
            "M√πa h√® v√† m√πa ƒë√¥ng.",
            "M√πa xu√¢n."
        ]
    },
    {
        "audioFile": "sentenceP3ht2.mp3",
        "notes": "Nghe v√† ch·ªçn ƒë√°p √°n ƒë√∫ng.",
        "question": "Anh H√† ƒëi Hu·∫ø ƒë·ªÉ l√†m g√¨?",
        "correctAnswer": "ƒê·ªÉ l√†m vi·ªác.",
        "options": [
            "ƒê·ªÉ du l·ªãch.",
            "ƒê·ªÉ g·∫∑p b·∫°n.",
            "ƒê·ªÉ l√†m vi·ªác.",
            "ƒê·ªÉ d·ª± ƒë√°m c∆∞·ªõi b·∫°n."
        ]
    },
    {
        "audioFile": "sentenceP3ht2.mp3",
        "notes": "Nghe v√† ch·ªçn ƒë√°p √°n ƒë√∫ng.",
        "question": "Ng√†y n√†o anh H√† s·∫Ω c√≥ m·∫∑t ·ªü H√† N·ªôi?",
        "correctAnswer": "Kho·∫£ng m·ªìng t√°m (08) th√°ng ba.",
        "options": [
            "Kho·∫£ng m·ªìng nƒÉm th√°ng ba.",
            "Kho·∫£ng m·ªìng t√°m th√°ng ba.",
            "Kho·∫£ng m·ªìng ba th√°ng ba.",
            "Kho·∫£ng m∆∞·ªùi ba th√°ng ba."
        ]
    },
    {
        "audioFile": "sentenceP3ht3.mp3",
        "notes": "Nghe v√† ch·ªçn ƒë√°p √°n ƒë√∫ng.",
        "question": "V√¨ sao, ·ªü H√† N·ªôi, ng∆∞·ªùi ta th∆∞·ªùng ƒëi l·∫°i b·∫±ng xe m√°y?",
        "correctAnswer": "V√¨ ƒë∆∞·ªùng ph·ªë H√† N·ªôi nh·ªè.",
        "options": [
            "V√¨ xe m√°y r·∫•t r·∫ª.",
            "V√¨ ƒë∆∞·ªùng ph·ªë H√† N·ªôi nh·ªè.",
            "V√¨ hay t·∫Øc ƒë∆∞·ªùng.",
            "V√¨ ƒëi l·∫°i b·∫±ng √¥ t√¥ ƒë·∫Øt."
        ]
    },
    {
        "audioFile": "sentenceP3ht3.mp3",
        "notes": "Nghe v√† ch·ªçn ƒë√°p √°n ƒë√∫ng.",
        "question": "V√¨ sao Ba kh√¥ng th√≠ch ƒë·∫øn tr∆∞·ªùng b·∫±ng xe bu√Ωt?",
        "correctAnswer": "V√¨ nh√† Ba xa b·∫øn xe bu√Ωt.",
        "options": [
            "V√¨ nh√† Ba xa b·∫øn xe bu√Ωt.",
            "V√¨ nh√† Ba g·∫ßn tr∆∞·ªùng.",
            "V√¨ Ba ƒë√£ c√≥ xe m√°y.",
            "V√¨ Ba th√≠ch ƒëi l·∫°i b·∫±ng xe ƒë·∫°p."
        ]
    }
];

            const sentenceP3bn = [
    {
        "audioFile": "sentenceP3bn1.mp3",
        "notes": "Nghe v√† ch·ªçn ƒë√°p √°n ƒë√∫ng.",
        "question": "Ng∆∞·ªùi ph·ª• n·ªØ ƒë√£ ƒëi c·ª≠a h√†ng ƒë·ªÉ mua g√¨?",
        "correctAnswer": "Mua qu·∫ßn √°o, t∆∞ trang cho m√¨nh.",
        "options": [
            "Mua qu·∫ßn √°o, t∆∞ trang cho gia ƒë√¨nh.",
            "Mua qu·∫ßn √°o, t∆∞ trang cho m√¨nh.",
            "Mua qu·∫ßn √°o cho con c√°i.",
            "Mua qu·∫ßn √°o, t∆∞ trang cho ch·ªìng."
        ]
    },
    {
        "audioFile": "sentenceP3bn1.mp3",
        "notes": "Nghe v√† ch·ªçn ƒë√°p √°n ƒë√∫ng.",
        "question": "V√¨ sao ng∆∞·ªùi ch·ªìng khen c√¥ b√°n h√†ng th√¥ng minh?",
        "correctAnswer": "C√¥ b√°n h√†ng bi·∫øt c√°ch l√†m cho kh√°ch h√†ng vui.",
        "options": [
            "C√¥ b√°n h√†ng b√°n ƒë∆∞·ª£c nhi·ªÅu h√†ng.",
            "C√¥ b√°n h√†ng bi·∫øt c√°ch l√†m cho kh√°ch h√†ng vui.",
            "C√¥ b√°n h√†ng ƒë√£ ƒëo√°n ch√≠nh x√°c tu·ªïi c·ªßa v·ª£ anh ·∫•y.",
            "C√¥ b√°n h√†ng kh√¥n ngoan."
        ]
    },
    {
        "audioFile": "sentenceP3bn2.mp3",
        "notes": "Nghe v√† ch·ªçn ƒë√°p √°n ƒë√∫ng.",
        "question": "N√©t ƒë·∫∑c tr∆∞ng c·ªßa ch·ª£ n·ªïi l√† g√¨?",
        "correctAnswer": "M·ªçi s·ª± mua b√°n, d·ªãch v·ª•, ƒÉn u·ªëng ƒë·ªÅu di·ªÖn ra tr√™n nh·ªØng chi·∫øc ghe, thuy·ªÅn.",
        "options": [
            "Ch·ª£ h·ªçp su·ªët c·∫£ ng√†y, nh∆∞ng nh·ªôn nh·ªãp nh·∫•t l√† v√†o bu·ªïi s√°ng.",
            "M·ªçi s·ª± mua b√°n, d·ªãch v·ª•, ƒÉn u·ªëng ƒë·ªÅu di·ªÖn ra tr√™n nh·ªØng chi·∫øc ghe, thuy·ªÅn.",
            "Ch·ª£ n·ªïi l√† n√©t sinh ho·∫°t ƒë·ªôc ƒë√°o c·ªßa v√πng ch√¢u th·ªï s√¥ng C·ª≠u Long.",
            "H√†ng h√≥a ƒë∆∞·ª£c ch·ªü ra t·∫≠n H√† N·ªôi v√† c√°c ƒë·ªãa ph∆∞∆°ng ngo√†i B·∫Øc."
        ]
    },
    {
        "audioFile": "sentenceP3bn2.mp3",
        "notes": "Nghe v√† ch·ªçn ƒë√°p √°n ƒë√∫ng.",
        "question": "Ph·∫ßn l·ªõn c√°c lo·∫°i n√¥ng s·∫£n, tr√°i c√¢y ·ªü ch·ª£ n·ªïi ƒë∆∞·ª£c:",
        "correctAnswer": "B√°n s·ªâ cho c√°c th∆∞∆°ng nh√¢n.",
        "options": [
            "B√°n l·∫ª cho c√°c th∆∞∆°ng nh√¢n.",
            "B√°n s·ªâ t·∫≠n tay ng∆∞·ªùi ti√™u d√πng.",
            "B√°n s·ªâ cho c√°c th∆∞∆°ng nh√¢n.",
            "B√°n l·∫ª cho ng∆∞·ªùi ti√™u d√πng."
        ]
    },
    {
        "audioFile": "sentenceP3bn3.mp3",
        "notes": "Nghe v√† ch·ªçn ƒë√°p √°n ƒë√∫ng.",
        "question": "N·ªôi dung ch√≠nh c·ªßa ƒëo·∫°n c√°c b·∫°n v·ª´a nghe l√† g√¨?",
        "correctAnswer": "V·∫•n ƒë·ªÅ gi√† h√≥a d√¢n s·ªë tr√™n th·∫ø gi·ªõi v√† ·ªü Vi·ªát Nam.",
        "options": [
            "V·∫•n ƒë·ªÅ gi√† h√≥a d√¢n s·ªë c·ªßa Vi·ªát Nam.",
            "V·∫•n ƒë·ªÅ gi√† h√≥a d√¢n s·ªë tr√™n th·∫ø gi·ªõi.",
            "Vai tr√≤ c·ªßa ng∆∞·ªùi gi√† ·ªü Vi·ªát Nam.",
            "V·∫•n ƒë·ªÅ gi√† h√≥a d√¢n s·ªë tr√™n th·∫ø gi·ªõi v√† ·ªü Vi·ªát Nam."
        ]
    },
    {
        "audioFile": "sentenceP3bn3.mp3",
        "notes": "Nghe v√† ch·ªçn ƒë√°p √°n ƒë√∫ng.",
        "question": "T·ª∑ l·ªá gi√† h√≥a d√¢n s·ªë c·ªßa ch√¢u √Å ƒë·ª©ng th·ª© m·∫•y tr√™n th·∫ø gi·ªõi?",
        "correctAnswer": "ƒê·ª©ng th·ª© ba.",
        "options": [
            "ƒê·ª©ng th·ª© hai.",
            "ƒê·ª©ng th·ª© ba.",
            "ƒê·ª©ng th·ª© t∆∞.",
            "ƒê·ª©ng th·ª© nƒÉm."
        ]
    },
    {
        "audioFile": "sentenceP3bn4.mp3",
        "notes": "Nghe v√† ch·ªçn ƒë√°p √°n ƒë√∫ng.",
        "question": "Ch√∫ng ta ph·∫£i ng·ªß ƒë·ªÉ:",
        "correctAnswer": "L·∫•y l·∫°i thƒÉng b·∫±ng cho c∆° th·ªÉ.",
        "options": [
            "ƒê√°p ·ª©ng nhu c·∫ßu sinh s·∫£n c·ªßa con ng∆∞·ªùi.",
            "Gi·∫£i t·ªèa m·ªát m·ªèi, cƒÉng th·∫≥ng ƒë·ªÉ b·∫Øt ƒë·∫ßu cho m·ªôt ng√†y m·ªõi.",
            "L·∫•y l·∫°i thƒÉng b·∫±ng cho c∆° th·ªÉ.",
            "C·∫£ A v√† B."
        ]
    },
    {
        "audioFile": "sentenceP3bn4.mp3",
        "notes": "Nghe v√† ch·ªçn ƒë√°p √°n ƒë√∫ng.",
        "question": "Ng·ªß s√¢u l√† c·∫ßn thi·∫øt ƒë·ªÉ:",
        "correctAnswer": "Gan ho√†n th√†nh vi·ªác lo·∫°i tr·ª´ c√°c ƒë·ªôc t·ªë trong c∆° th·ªÉ.",
        "options": [
            "Gan ho√†n th√†nh vi·ªác lo·∫°i tr·ª´ c√°c ƒë·ªôc t·ªë trong c∆° th·ªÉ.",
            "Tr√°nh ng·ªß g·∫≠t trong h·ªôi ngh·ªã, l·ªõp h·ªçc, c√¥ng s·ªü v√†o ng√†y h√¥m sau.",
            "Tr√°nh t√¨nh tr·∫°ng gan nhi·ªÖm m·ª°, m·ªôt cƒÉn b·ªánh ph·ªï bi·∫øn hi·ªán nay.",
            "Tr·ª£ gi√∫p gan b·∫Øt ƒë·∫ßu qu√° tr√¨nh b√†i ti·∫øt."
        ]
    }
];

            const sentenceP4 = [
    {
        "audioFile": "sentenceP4-1.mp3",
        "notes": "Nghe v√† ch·ªçn ƒë√°p √°n ƒë√∫ng.",
        "question": "Trong ƒëi·ªÅu ki·ªán t·ª± nhi√™n, n∆∞·ªõc t·ªìn t·∫°i d∆∞·ªõi m·∫•y d·∫°ng?",
        "correctAnswer": "T·ªìn t·∫°i d∆∞·ªõi 3 d·∫°ng.",
        "options": [
            "T·ªìn t·∫°i d∆∞·ªõi 2 d·∫°ng.",
            "T·ªìn t·∫°i d∆∞·ªõi 3 d·∫°ng.",
            "T·ªìn t·∫°i d∆∞·ªõi 4 d·∫°ng.",
            "T·ªìn t·∫°i m·ªôt c√°ch v√¥ h√¨nh."
        ]
    },
    {
        "audioFile": "sentenceP4-1.mp3",
        "notes": "Nghe v√† ch·ªçn ƒë√°p √°n ƒë√∫ng.",
        "question": "M·ªôt chu k·ª≥ n∆∞·ªõc g·ªìm 4 giai ƒëo·∫°n. Giai ƒëo·∫°n ƒë·∫ßu ti√™n v√† cu·ªëi c√πng n∆∞·ªõc t·ªìn t·∫°i d∆∞·ªõi d·∫°ng n√†o?",
        "correctAnswer": "T·ªìn t·∫°i d∆∞·ªõi d·∫°ng l·ªèng.",
        "options": [
            "T·ªìn t·∫°i d∆∞·ªõi d·∫°ng r·∫Øn.",
            "T·ªìn t·∫°i d∆∞·ªõi d·∫°ng kh√≠.",
            "T·ªìn t·∫°i d∆∞·ªõi d·∫°ng l·ªèng.",
            "T·ªìn t·∫°i d∆∞·ªõi c·∫£ 3 d·∫°ng tr√™n."
        ]
    },
    {
        "audioFile": "sentenceP4-2.mp3",
        "notes": "Nghe v√† ch·ªçn ƒë√°p √°n ƒë√∫ng.",
        "question": "T√°c gi·∫£ ƒë√£ ƒë∆∞a ra m·∫•y l√Ω do khi ph√¢n t√≠ch t√°c h·∫°i c·ªßa tr√≤ ch∆°i x·ªï s·ªë nh√† n∆∞·ªõc?",
        "correctAnswer": "Ba l√≠ do.",
        "options": [
            "Hai l√≠ do.",
            "Ba l√≠ do.",
            "B·ªën l√≠ do.",
            "NƒÉm l√≠ do."
        ]
    },
    {
        "audioFile": "sentenceP4-2.mp3",
        "notes": "Nghe v√† ch·ªçn ƒë√°p √°n ƒë√∫ng.",
        "question": "Th√°i ƒë·ªô c·ªßa t√°c gi·∫£ ƒë·ªëi v·ªõi vi·ªác ch∆°i x·ªï s·ªë nh∆∞ th·∫ø n√†o?",
        "correctAnswer": "Ph·∫£n ƒë·ªëi ho√†n to√†n vi·ªác ch∆°i x·ªï s·ªë.",
        "options": [
            "·ª¶ng h·ªô ho√†n to√†n vi·ªác ch∆°i x·ªï s·ªë.",
            "Ph·∫£n ƒë·ªëi ho√†n to√†n vi·ªác ch∆°i x·ªï s·ªë.",
            "V·ª´a ·ªßng h·ªô v·ª´a ph·∫£n ƒë·ªëi vi·ªác ch∆°i x·ªï s·ªë.",
            "Kh√¥ng th·ªÉ hi·ªán quan ƒëi·ªÉm, th√°i ƒë·ªô c·ªßa m√¨nh."
        ]
    },
    {
        "audioFile": "sentenceP4-3.mp3",
        "notes": "Nghe v√† ch·ªçn ƒë√°p √°n ƒë√∫ng.",
        "question": "H√£y cho bi·∫øt m√°y bay g·∫∑p tai n·∫°n nhi·ªÅu h∆°n khi c·∫•t c√°nh hay h·∫° c√°nh?",
        "correctAnswer": "Khi h·∫° c√°nh g·∫∑p nhi·ªÅu h∆°n khi c·∫•t c√°nh.",
        "options": [
            "Khi c·∫•t c√°nh v√† h·∫° c√°nh ƒë·ªÅu b·∫±ng nhau.",
            "Khi c·∫•t c√°nh g·∫∑p nhi·ªÅu h∆°n khi h·∫° c√°nh.",
            "Khi h·∫° c√°nh g·∫∑p nhi·ªÅu h∆°n khi c·∫•t c√°nh.",
            "C·∫£ khi c·∫•t c√°nh l·∫´n h·∫° c√°nh ƒë·ªÅu g·∫∑p tai n·∫°n nhi·ªÅu nh·∫•t."
        ]
    },
    {
        "audioFile": "sentenceP4-3.mp3",
        "notes": "Nghe v√† ch·ªçn ƒë√°p √°n ƒë√∫ng.",
        "question": "Theo s·ªë li·ªáu t·ªïng k·∫øt tai n·∫°n m√°y bay t·ª´ 1950 ƒë·∫øn 2004 th√¨ nguy√™n nh√¢n n√†o chi·∫øm s·ªë l∆∞·ª£ng nhi·ªÅu nh·∫•t?",
        "correctAnswer": "Do sai l·∫ßm c·ªßa ng∆∞·ªùi l√°i.",
        "options": [
            "Do tr·ª•c tr·∫∑c m√°y m√≥c.",
            "Do kh√¥ng r√µ nguy√™n nh√¢n.",
            "Do th·ªùi ti·∫øt.",
            "Do sai l·∫ßm c·ªßa ng∆∞·ªùi l√°i."
        ]
    },
    {
        "audioFile": "sentenceP4-4.mp3",
        "notes": "Nghe v√† ch·ªçn ƒë√°p √°n ƒë√∫ng.",
        "question": "H√£y cho bi·∫øt, th√†nh ng·ªØ ‚Äúnam thanh n·ªØ t√∫‚Äù nghƒ©a l√† g√¨?",
        "correctAnswer": "Nam v√† n·ªØ thanh ni√™n tr·∫ª, ƒë·∫πp.",
        "options": [
            "Nam v√† n·ªØ b·∫°n b√®.",
            "Nam v√† n·ªØ thanh ni√™n.",
            "Nam v√† n·ªØ thanh ni√™n tr·∫ª, ƒë·∫πp.",
            "N·ªØ l√†m ph√π d√¢u, nam l√†m ph√π r·ªÉ."
        ]
    },
    {
        "audioFile": "sentenceP4-4.mp3",
        "notes": "Nghe v√† ch·ªçn ƒë√°p √°n ƒë√∫ng.",
        "question": "Trong c√°c ƒë√°m c∆∞·ªõi th·ªùi x∆∞a, c√°c ph√π d√¢u c√≥ nh·ªØng nhi·ªám v·ª• g√¨?",
        "correctAnswer": "ƒê·ªÉ truy·ªÅn kinh nghi·ªám l√†m d√¢u, l√†m v·ª£, l√†m m·∫π.",
        "options": [
            "L√†m cho ƒë√°m c∆∞·ªõi th√™m ƒë·∫πp, th√™m vui.",
            "ƒê·ªÉ truy·ªÅn kinh nghi·ªám l√†m d√¢u, l√†m v·ª£, l√†m m·∫π.",
            "ƒê·ªÉ gi√∫p ƒë·ª° c√¥ d√¢u l√∫c ·ªëm ƒëau.",
            "ƒê·ªÉ l√†m n·ªÅn cho c√¥ d√¢u th√™m ƒë·∫πp h∆°n, xinh h∆°n."
        ]
    },
    {
        "audioFile": "sentenceP4-5.mp3",
        "notes": "Nghe v√† ch·ªçn ƒë√°p √°n ƒë√∫ng.",
        "question": "N·ªôi dung ch√≠nh c·ªßa ƒëo·∫°n m√† b·∫°n v·ª´a nghe ch·ªß y·∫øu ƒë·ªÅ c·∫≠p ƒë·∫øn:",
        "correctAnswer": "Ch·ªß y·∫øu l√† quan ni·ªám v·ªÅ vi·ªác sinh con c·ªßa ng∆∞·ªùi Vi·ªát.",
        "options": [
            "Vi·ªác l·∫≠p gia ƒë√¨nh v√† sinh con c·ªßa ng∆∞·ªùi Vi·ªát.",
            "Ch√≠nh s√°ch sinh ƒë·∫ª c·ªßa Nh√† n∆∞·ªõc Vi·ªát Nam.",
            "X√£ h·ªôi Vi·ªát Nam l√† m·ªôt x√£ h·ªôi ph·ª• h·ªá.",
            "Ch·ªß y·∫øu l√† quan ni·ªám v·ªÅ vi·ªác sinh con c·ªßa ng∆∞·ªùi Vi·ªát."
        ]
    },
    {
        "audioFile": "sentenceP4-5.mp3",
        "notes": "Nghe v√† ch·ªçn ƒë√°p √°n ƒë√∫ng.",
        "question": "ƒêi·ªÅu g√¨ d∆∞·ªõi ƒë√¢y th·ªÉ hi·ªán cao nh·∫•t m·ª©c ƒë·ªô quan tr·ªçng c·ªßa vi·ªác c√≥ con ƒë·ªëi v·ªõi ng∆∞·ªùi Vi·ªát?",
        "correctAnswer": "N·∫øu kh√¥ng c√≥ con th√¨ h·ªç xin con nu√¥i ho·∫∑c k·∫øt h√¥n l·∫ßn hai v√† sinh con.",
        "options": [
            "N·∫øu hai v·ª£ ch·ªìng c√≥ con th√¨ quan h·ªá b·ªÅn ch·∫∑t h∆°n.",
            "N·∫øu hai v·ª£ ch·ªìng c√≥ con th√¨ h·ªç c·∫£m th·∫•y h·∫°nh ph√∫c h∆°n.",
            "N·∫øu hai v·ª£ ch·ªìng c√≥ con th√¨ h·ªç c√≥ nhi·ªÅu tr√°ch nhi·ªám h∆°n.",
            "N·∫øu kh√¥ng c√≥ con th√¨ h·ªç xin con nu√¥i ho·∫∑c k·∫øt h√¥n l·∫ßn hai v√† sinh con."
        ]
    },
    {
        "audioFile": "sentenceP4-6.mp3",
        "notes": "Nghe v√† ch·ªçn ƒë√°p √°n ƒë√∫ng.",
        "question": "Chu·ªôt ƒë·ªìng th·∫•y th·ª©c ƒÉn th∆∞·ªùng ng√†y c·ªßa Chu·ªôt nh√† g·ªìm:",
        "correctAnswer": "ƒê·ªó, th√≥c, pho m√°t, m·∫≠t ong...",
        "options": [
            "ƒê·ªó, th√≥c, pho m√°t...",
            "ƒê·ªó, th√≥c, pho m√°t, m·∫≠t ong...",
            "ƒê·ªó, th√≥c, pho m√°t, m·∫≠t ong, ƒë·∫°i m·∫°ch.",
            "Th√≥c, pho m√°t, m·∫≠t ong, ƒë·∫°i m·∫°ch...."
        ]
    },
    {
        "audioFile": "sentenceP4-6.mp3",
        "notes": "Nghe v√† ch·ªçn ƒë√°p √°n ƒë√∫ng.",
        "question": "Chu·ªôt ƒë·ªìng t·∫°m bi·ªát Chu·ªôt nh√†, b·ªè th√†nh ph·ªë v·ªÅ qu√™ c√≥ ng·ª• √Ω g√¨?",
        "correctAnswer": "Th√† s·ªëng gi·∫£n d·ªã trong b√¨nh y√™n c√≤n h∆°n sung t√∫c, ƒë·∫ßy ƒë·ªß trong lo l·∫Øng, s·ª£ h√£i.",
        "options": [
            "Cu·ªôc s·ªëng th√†nh ph·ªë kh√¥ng h·ª£p v·ªõi Chu·ªôt ƒë·ªìng.",
            "Chu·ªôt ƒë·ªìng v√† chu·ªôt nh√† c√≥ quan ƒëi·ªÉm s·ªëng kh√°c nhau.",
            "Th√† s·ªëng gi·∫£n d·ªã trong b√¨nh y√™n c√≤n h∆°n sung t√∫c, ƒë·∫ßy ƒë·ªß trong lo l·∫Øng, s·ª£ h√£i.",
            "Cu·ªôc s·ªëng th√†nh ph·ªë sung t√∫c, ƒë·∫ßy ƒë·ªß nh∆∞ng lu√¥n s·ªëng trong lo l·∫Øng s·ª£ h√£i."
        ]
    }
];
    // --- COMBINED DATA AND STATE MANAGEMENT ---
    const allQuestions = [
        ...sentenceP1,
        ...sentenceP2ht,
        ...sentenceP2mt,
        ...sentenceP2bn,
        ...sentenceP3ht,
        ...sentenceP3bn,
        ...sentenceP4
    ];
    const questionGroups = [];
    let currentGlobalIndex = 1;

    // --- NEW: Cache tr·∫≠t t·ª± ƒë√£ x√°o cho t·ª´ng c√¢u (m·ªói c√¢u = 1 l·∫ßn x√°o trong phi√™n) ---
    const shuffledOptionsCache = {}; // key: s·ªë c√¢u (1-based), value: m·∫£ng ƒë√°p √°n ƒë√£ x√°o (ƒë√≥ng bƒÉng)

    // --- NEW: H√†m x√°o tr·ªôn Fisher‚ÄìYates (t·∫°o b·∫£n sao, kh√¥ng ph√° m·∫£ng g·ªëc) ---
    function shuffleArray(array) {
        const arr = array.slice();
        for (let i = arr.length - 1; i > 0; i--) {
            const j = Math.floor(Math.random() * (i + 1));
            [arr[i], arr[j]] = [arr[j], arr[i]];
        }
        return arr;
    }

    // --- NEW: L·∫•y tr·∫≠t t·ª± ƒë√°p √°n ƒë√£ x√°o c·ªßa 1 c√¢u; n·∫øu ch∆∞a c√≥ th√¨ x√°o v√† l∆∞u ---
    function getShuffledOptions(questionNumber, optionsArray) {
        if (!shuffledOptionsCache[questionNumber]) {
            const shuffled = shuffleArray(optionsArray);
            shuffledOptionsCache[questionNumber] = Object.freeze(shuffled);
        }
        return shuffledOptionsCache[questionNumber];
    }

    // Group Part 1 questions (1 question per audio)
    for (let i = 0; i < sentenceP1.length; i++) {
        questionGroups.push({
            questions: [allQuestions[currentGlobalIndex - 1]],
            startQuestion: currentGlobalIndex,
            endQuestion: currentGlobalIndex,
            part: 1
        });
        currentGlobalIndex++;
    }

    // Group Part 2 questions
    for (let i = 0; i < sentenceP2ht.length; i++) {
        questionGroups.push({
            questions: [allQuestions[currentGlobalIndex - 1]],
            startQuestion: currentGlobalIndex,
            endQuestion: currentGlobalIndex,
            part: 2
        });
        currentGlobalIndex++;
    }
    for (let i = 0; i < sentenceP2mt.length; i++) {
        questionGroups.push({
            questions: [allQuestions[currentGlobalIndex - 1]],
            startQuestion: currentGlobalIndex,
            endQuestion: currentGlobalIndex,
            part: 2
        });
        currentGlobalIndex++;
    }
    for (let i = 0; i < sentenceP2bn.length; i += 2) {
        questionGroups.push({
            questions: [allQuestions[currentGlobalIndex - 1], allQuestions[currentGlobalIndex]],
            startQuestion: currentGlobalIndex,
            endQuestion: currentGlobalIndex + 1,
            part: 2
        });
        currentGlobalIndex += 2;
    }

    // Group Part 3 questions
    for (let i = 0; i < sentenceP3ht.length; i += 2) {
        questionGroups.push({
            questions: [allQuestions[currentGlobalIndex - 1], allQuestions[currentGlobalIndex]],
            startQuestion: currentGlobalIndex,
            endQuestion: currentGlobalIndex + 1,
            part: 3
        });
        currentGlobalIndex += 2;
    }
    for (let i = 0; i < sentenceP3bn.length; i += 2) {
        questionGroups.push({
            questions: [allQuestions[currentGlobalIndex - 1], allQuestions[currentGlobalIndex]],
            startQuestion: currentGlobalIndex,
            endQuestion: currentGlobalIndex + 1,
            part: 3
        });
        currentGlobalIndex += 2;
    }

    // Group Part 4 questions (12 questions, 2 per audio)
    for (let i = 0; i < sentenceP4.length; i += 2) {
        questionGroups.push({
            questions: [allQuestions[currentGlobalIndex - 1], allQuestions[currentGlobalIndex]],
            startQuestion: currentGlobalIndex,
            endQuestion: currentGlobalIndex + 1,
            part: 4
        });
        currentGlobalIndex += 2;
    }

    // App state
    let currentGroupIndex = 0;
    const userAnswers = {};
    let autoContinueEnabled = false;

    // --- UI ELEMENTS ---
    const questionContainer = document.getElementById('question-container');
    const audioPlayer = document.getElementById('audioPlayer');
    const instructionBox = document.getElementById('current-section');
    const indicatorList = document.getElementById('indicator-list');
    const questionNumberDisplay = document.getElementById('questionNumberDisplay');
    const prevBtn = document.getElementById('prevBtn');
    const nextBtn = document.getElementById('nextBtn');
    const replayBtn = document.getElementById('replayBtn');
    const autoContinueCheckbox = document.getElementById('autoContinue');

    // Audio Controls Elements
    const timeDisplay = document.getElementById("timeDisplay");
    const loopStartEl = document.getElementById("loopStart");
    const loopEndEl = document.getElementById("loopEnd");
    const loopButton = document.getElementById("loopButton");
    const clearButton = document.getElementById("clearButton");
    const rewind5sButton = document.getElementById("rewind5sButton");
    const rewind1sButton = document.getElementById("rewind1sButton");
    const forward1sButton = document.getElementById("forward1sButton");
    const forward5sButton = document.getElementById("forward5sButton");
    const pausePlayButton = document.getElementById("pausePlayButton");
    const toggleControlsButton = document.getElementById("toggleControlsButton");
    const tuaButtons = document.querySelector(".tua-buttons");

    // Audio Control Variables
    let customLoopStart = null;
    let customLoopEnd = null;
    let clickCount = 0;
    let isLooping = false;
    let controlsVisible = true;

    // --- AUDIO CONTROL FUNCTIONS ---
    function toggleAudioControls(disable) {
        const elements = [
            { element: rewind5sButton, container: tuaButtons },
            { element: rewind1sButton, container: tuaButtons },
            { element: forward1sButton, container: tuaButtons },
            { element: forward5sButton, container: tuaButtons },
            { element: pausePlayButton, container: document.querySelector('.action-buttons') },
            { element: loopButton, container: document.querySelector('.button-group') },
            { element: clearButton, container: document.querySelector('.button-group') },
            { element: timeDisplay, container: document.querySelector('.time-row') },
            { element: loopStartEl, container: document.querySelector('.time-box-group') },
            { element: loopEndEl, container: document.querySelector('.time-box-group') }
        ];
        elements.forEach(({ element, container }) => {
            if (disable) {
                element.classList.add('disabled');
                element.style.display = 'none';
                if (container && !container.querySelectorAll('.control-button:not(.disabled), .time-box:not(.disabled), p#timeDisplay:not(.disabled)').length) {
                    container.style.display = 'none';
                }
            } else {
                element.classList.remove('disabled');
                element.style.display = '';
                if (container) {
                    container.style.display = '';
                }
            }
        });
        toggleControlsButton.classList.remove('disabled');
        toggleControlsButton.style.display = '';
        toggleControlsButton.disabled = false;
    }

    function formatTime(seconds) {
        if (seconds === undefined || seconds === null || isNaN(seconds)) {
            return "--:--";
        }
        const minutes = Math.floor(seconds / 60);
        const secs = Math.floor(seconds % 60);
        return `${minutes.toString().padStart(2, '0')}:${secs.toString().padStart(2, '0')}`;
    }

    function updateTimeDisplay() {
        timeDisplay.textContent = formatTime(audioPlayer.currentTime);
    }

    const updateInterval = setInterval(updateTimeDisplay, 1000);

    timeDisplay.onclick = () => {
        if (audioPlayer.paused) {
            clickCount++;
            if (clickCount === 1) {
                customLoopStart = audioPlayer.currentTime;
                loopStartEl.textContent = formatTime(customLoopStart);
            } else if (clickCount === 2) {
                customLoopEnd = audioPlayer.currentTime;
                if (customLoopEnd <= customLoopStart) {
                    customLoopEnd = null;
                    loopEndEl.textContent = "--:--";
                } else {
                    loopEndEl.textContent = formatTime(customLoopEnd);
                }
                clickCount = 0;
            }
        }
    };

    audioPlayer.ontimeupdate = function() {
        updateTimeDisplay();
        if (isLooping && customLoopStart !== null && customLoopEnd !== null) {
            if (audioPlayer.currentTime >= customLoopEnd) {
                audioPlayer.currentTime = customLoopStart;
                audioPlayer.play();
            }
        }
    };

    audioPlayer.onerror = function() {
        console.error("L·ªói t·∫£i file √¢m thanh:", audioPlayer.src);
        alert("Kh√¥ng th·ªÉ t·∫£i file √¢m thanh: " + audioPlayer.src);
    };

    rewind5sButton.onclick = () => {
        if (!isLooping) {
            audioPlayer.currentTime = Math.max(0, audioPlayer.currentTime - 5);
            updateTimeDisplay();
        }
    };
    rewind1sButton.onclick = () => {
        if (!isLooping) {
            audioPlayer.currentTime = Math.max(0, audioPlayer.currentTime - 1);
            updateTimeDisplay();
        }
    };
    forward1sButton.onclick = () => {
        if (!isLooping) {
            audioPlayer.currentTime = Math.min(audioPlayer.duration || Infinity, audioPlayer.currentTime + 1);
            updateTimeDisplay();
        }
    };
    forward5sButton.onclick = () => {
        if (!isLooping) {
            audioPlayer.currentTime = Math.min(audioPlayer.duration || Infinity, audioPlayer.currentTime + 5);
            updateTimeDisplay();
        }
    };

    pausePlayButton.onclick = () => {
        if (audioPlayer.paused) {
            audioPlayer.play().catch(error => {
                console.error("L·ªói khi ph√°t √¢m thanh:", error);
            });
            pausePlayButton.textContent = "ÂÅú";
        } else {
            audioPlayer.pause();
            pausePlayButton.textContent = "Êí≠";
        }
    };

    loopButton.onclick = () => {
        if (customLoopStart !== null && customLoopEnd !== null) {
            audioPlayer.currentTime = customLoopStart;
            audioPlayer.play().catch(error => {
                console.error("L·ªói khi ph√°t √¢m thanh trong ch·∫ø ƒë·ªô l·∫∑p:", error);
            });
            isLooping = true;
        }
    };

    clearButton.onclick = () => {
        customLoopStart = null;
        customLoopEnd = null;
        loopStartEl.textContent = "--:--";
        loopEndEl.textContent = "--:--";
        clickCount = 0;
        isLooping = false;
        rewind5sButton.disabled = false;
        rewind1sButton.disabled = false;
        forward1sButton.disabled = false;
        forward5sButton.disabled = false;
    };

    toggleControlsButton.onclick = () => {
        if (controlsVisible) {
            timeDisplay.style.display = "none";
            tuaButtons.style.display = "none";
            pausePlayButton.style.display = "none";
            loopStartEl.style.display = "none";
            loopEndEl.style.display = "none";
            loopButton.style.display = "none";
            clearButton.style.display = "none";
            document.querySelector('.time-row').style.display = "none";
            document.querySelector('.time-box-group').style.display = "none";
            document.querySelector('.button-group').style.display = "none";
            toggleControlsButton.textContent = "Á§∫";
            controlsVisible = false;
        } else {
            timeDisplay.style.display = "inline-block";
            tuaButtons.style.display = "flex";
            pausePlayButton.style.display = "inline-flex";
            loopStartEl.style.display = "inline-block";
            loopEndEl.style.display = "inline-block";
            loopButton.style.display = "inline-flex";
            clearButton.style.display = "inline-flex";
            document.querySelector('.time-row').style.display = "flex";
            document.querySelector('.time-box-group').style.display = "flex";
            document.querySelector('.button-group').style.display = "flex";
            toggleControlsButton.textContent = "Ëóè";
            controlsVisible = true;
        }
        const isSentenceP1 = questionGroups[currentGroupIndex]?.questions[0]?.audioFile === "sentenceP1.mp3";
        if (isSentenceP1) {
            toggleAudioControls(true);
        }
    };

    audioPlayer.onpause = audioPlayer.onended = function() {
        pausePlayButton.textContent = "Êí≠";
    };

    // --- CORE FUNCTIONS ---
    function renderQuestionGroup() {
        if (currentGroupIndex >= questionGroups.length) {
            showResult();
            return;
        }

        const group = questionGroups[currentGroupIndex];
        const start = group.startQuestion;
        const end = group.endQuestion;
        const isSentenceP1 = group.questions[0].audioFile === "sentenceP1.mp3";

        // Update instruction box
        let questionNumberText = (start === end) ? `${start}` : `${start}-${end}`;
        instructionBox.textContent = `Ph·∫ßn ${group.part} - C√¢u ${questionNumberText}`;
        questionNumberDisplay.textContent = questionNumberText;

        // Render questions
        questionContainer.innerHTML = '';
        group.questions.forEach((q, i) => {
            const globalIndex = start + i;
            const questionCard = document.createElement('div');
            questionCard.classList.add('question-card', 'bg-gray-50', 'p-6', 'rounded-xl', 'shadow-sm', 'mb-4');
            questionCard.id = `question-card-${globalIndex}`;
            questionCard.innerHTML = `
                <p class="text-sm text-gray-500 italic mb-2">Ch√∫ √Ω: ${q.notes}</p>
                <h4 class="text-lg font-bold mb-4">C√¢u ${globalIndex}: ${q.question}</h4>
                <div id="options-${globalIndex}" class="space-y-3"></div>
            `;
            questionContainer.appendChild(questionCard);

            const optionsContainer = document.getElementById(`options-${globalIndex}`);

            // --- NEW: L·∫•y tr·∫≠t t·ª± ƒë√°p √°n ƒë√£ x√°o (nh·∫•t qu√°n trong phi√™n) ---
            const shuffledOptions = getShuffledOptions(globalIndex, q.options);

            shuffledOptions.forEach(option => {
                const optionElement = document.createElement('div');
                optionElement.classList.add('question-option', 'p-3', 'bg-white', 'rounded-lg', 'border', 'border-gray-200', 'hover:border-blue-400');
                optionElement.textContent = option;
                optionsContainer.appendChild(optionElement);

                if (userAnswers[globalIndex] && userAnswers[globalIndex].selectedOption === option) {
                    optionElement.classList.add('selected');
                }

                optionElement.addEventListener('click', () => {
                    handleAnswer(globalIndex, option);
                });
            });
        });

        // Disable/enable audio controls
        toggleAudioControls(isSentenceP1);
        if (!controlsVisible) {
            document.querySelector('.time-row').style.display = "none";
            document.querySelector('.time-box-group').style.display = "none";
            document.querySelector('.button-group').style.display = "none";
            tuaButtons.style.display = "none";
            pausePlayButton.style.display = "none";
            toggleControlsButton.textContent = "Á§∫";
        }

        // Play audio and set loop points
        const questionData = group.questions[0];
        audioPlayer.src = questionData.audioFile;
        audioPlayer.load();

        audioPlayer.onloadedmetadata = () => {
            const startTime = questionData.start || 0;
            const endTime = questionData.end || audioPlayer.duration;

            // Reset custom loop points for new question group
            clearButton.onclick();

            loopStartEl.textContent = formatTime(startTime);
            loopEndEl.textContent = formatTime(endTime);

            audioPlayer.currentTime = startTime;
            audioPlayer.play().catch(error => {
                console.error("L·ªói khi ph√°t √¢m thanh:", error);
            });

            const stopPlayback = () => {
                if (audioPlayer.currentTime >= endTime && !isLooping) {
                    audioPlayer.pause();
                    audioPlayer.removeEventListener('timeupdate', stopPlayback);
                }
            };
            audioPlayer.addEventListener('timeupdate', stopPlayback);
        };

        updateUI();
    }

    function playAudio(questionData) {
        audioPlayer.src = questionData.audioFile;
        audioPlayer.load();

        const isSentenceP1 = questionData.audioFile === "sentenceP1.mp3";
        toggleAudioControls(isSentenceP1);

        audioPlayer.onloadedmetadata = () => {
            const start = isSentenceP1 ? (questionData.start || 0) : (customLoopStart !== null ? customLoopStart : (questionData.start || 0));
            const end = isSentenceP1 ? (questionData.end || audioPlayer.duration) : (customLoopEnd !== null ? customLoopEnd : (questionData.end || audioPlayer.duration));

            loopStartEl.textContent = formatTime(start);
            loopEndEl.textContent = formatTime(end);

            audioPlayer.currentTime = start;
            audioPlayer.play().catch(error => {
                console.error("L·ªói khi ph√°t √¢m thanh:", error);
            });

            const stopPlayback = () => {
                if (audioPlayer.currentTime >= end && !isLooping) {
                    audioPlayer.pause();
                    audioPlayer.removeEventListener('timeupdate', stopPlayback);
                }
            };
            audioPlayer.addEventListener('timeupdate', stopPlayback);
        };
    }

    function handleAnswer(questionIndex, selectedOption) {
        const group = questionGroups[currentGroupIndex];
        const globalIndicesInGroup = group.questions.map((_, i) => group.startQuestion + i);

        userAnswers[questionIndex] = {
            selectedOption: selectedOption,
            correctAnswer: allQuestions[questionIndex - 1].correctAnswer
        };

        const optionsContainer = document.getElementById(`options-${questionIndex}`);
        if (optionsContainer) {
            Array.from(optionsContainer.children).forEach(optionEl => {
                optionEl.classList.remove('selected');
            });
            const selectedEl = Array.from(optionsContainer.children).find(el => el.textContent === selectedOption);
            if (selectedEl) {
                selectedEl.classList.add('selected');
            }
        }

        updateUI();

        if (autoContinueEnabled) {
            const allAnsweredInGroup = globalIndicesInGroup.every(idx => userAnswers[idx]);
            if (allAnsweredInGroup) {
                setTimeout(nextQuestion, 500);
            }
        }
    }

    function jumpToQuestion(questionNumber) {
        const targetIndex = questionGroups.findIndex(group =>
            questionNumber >= group.startQuestion && questionNumber <= group.endQuestion
        );
        if (targetIndex !== -1 && targetIndex !== currentGroupIndex) {
            currentGroupIndex = targetIndex;
            renderQuestionGroup();
        }
    }

    function updateUI() {
        indicatorList.innerHTML = '';
        const allQuestionNumbers = Array.from({length: allQuestions.length}, (_, i) => i + 1);
        const currentGroup = questionGroups[currentGroupIndex];
        const currentStart = currentGroup ? currentGroup.startQuestion : null;
        const currentEnd = currentGroup ? currentGroup.endQuestion : null;

        allQuestionNumbers.forEach(num => {
            const isAnswered = userAnswers[num] !== undefined;
            const indicatorItem = document.createElement('span');
            indicatorItem.textContent = num;
            indicatorItem.classList.add('indicator-item', 'py-1', 'px-2', 'rounded-full', 'font-semibold', 'transition-colors', 'duration-200', 'cursor-pointer');
            if (isAnswered) {
                indicatorItem.classList.add('bg-green-200', 'text-green-800');
            } else {
                indicatorItem.classList.add('bg-red-200', 'text-red-800');
            }
            if (currentStart && currentEnd && num >= currentStart && num <= currentEnd) {
                indicatorItem.classList.add('active');
            }
            indicatorItem.addEventListener('click', () => {
                jumpToQuestion(num);
            });
            indicatorList.appendChild(indicatorItem);
        });
    }

    function nextQuestion() {
        if (currentGroupIndex < questionGroups.length - 1) {
            currentGroupIndex++;
            renderQuestionGroup();
        } else {
            showResult();
        }
    }

    function prevQuestion() {
        if (currentGroupIndex > 0) {
            currentGroupIndex--;
            renderQuestionGroup();
        }
    }

    function showResult() {
        const totalQuestions = allQuestions.length;
        let correctAnswers = 0;

        for (let i = 1; i <= totalQuestions; i++) {
            const userAnswer = userAnswers[i];
            if (userAnswer && userAnswer.selectedOption === userAnswer.correctAnswer) {
                correctAnswers++;
            }
        }

        questionContainer.innerHTML = `
            <div class="result-container text-center p-8 bg-blue-50 rounded-xl shadow-lg">
                <h2 class="text-3xl font-bold text-blue-800 mb-4">K·∫øt qu·∫£ b√†i thi</h2>
                <p class="text-xl text-gray-700 mb-2">B·∫°n ƒë√£ ho√†n th√†nh b√†i thi.</p>
                <p class="text-2xl font-extrabold text-blue-600">B·∫°n tr·∫£ l·ªùi ƒë√∫ng ${correctAnswers} tr√™n t·ªïng s·ªë ${totalQuestions} c√¢u.</p>
                <div class="mt-8 text-left space-y-4">
                    <h3 class="text-xl font-bold">B√°o c√°o chi ti·∫øt</h3>
                    <div id="detailed-report" class="space-y-2"></div>
                </div>
            </div>
        `;

        const detailedReport = document.getElementById('detailed-report');
        for (let i = 1; i <= totalQuestions; i++) {
            const questionData = allQuestions[i - 1];
            const userAnswer = userAnswers[i];
            const isCorrect = userAnswer && userAnswer.selectedOption === questionData.correctAnswer;
            const resultText = isCorrect ? "ƒê√∫ng" : "Sai";
            const resultColor = isCorrect ? "text-green-600" : "text-red-600";

            const reportItem = document.createElement('div');
            reportItem.classList.add('p-3', 'bg-white', 'rounded-md', 'shadow-sm');
            reportItem.innerHTML = `
                <p class="font-semibold">C√¢u ${i}:</p>
                <p class="ml-4">ƒê√°p √°n c·ªßa b·∫°n: <strong>${userAnswer ? userAnswer.selectedOption : "Ch∆∞a tr·∫£ l·ªùi"}</strong></p>
                <p class="ml-4">ƒê√°p √°n ƒë√∫ng: <strong>${questionData.correctAnswer}</strong></p>
                <p class="ml-4 ${resultColor}">K·∫øt qu·∫£: <strong>${resultText}</strong></p>
            `;
            detailedReport.appendChild(reportItem);
        }

        document.querySelector('.controls-container').style.display = 'none';
        document.getElementById('floatingControls').style.display = 'none';
    }

    // --- EVENT LISTENERS ---
    prevBtn.addEventListener('click', prevQuestion);
    nextBtn.addEventListener('click', nextQuestion);
    replayBtn.addEventListener('click', () => {
        const currentGroup = questionGroups[currentGroupIndex];
        clearButton.onclick();
        playAudio(currentGroup.questions[0]);
    });
    autoContinueCheckbox.addEventListener('change', (e) => {
        autoContinueEnabled = e.target.checked;
    });

    // Initial render
    renderQuestionGroup();
});
</script>
</body>
</html>